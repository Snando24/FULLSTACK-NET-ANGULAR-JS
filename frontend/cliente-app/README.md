# Sistema de Gesti√≥n de Clientes - Frontend Angular

Este es el frontend de la aplicaci√≥n de gesti√≥n de clientes desarrollado con Angular 19.

## Caracter√≠sticas

- ‚úÖ Lista de clientes con paginaci√≥n
- ‚úÖ **B√∫squeda avanzada en tiempo real** por RUC y Raz√≥n Social
- ‚úÖ **Resaltado de resultados** de b√∫squeda
- ‚úÖ **Ordenamiento** por cualquier columna (ascendente/descendente)
- ‚úÖ **Filtros din√°micos** con indicadores de estado
- ‚úÖ Crear nuevos clientes
- ‚úÖ Editar clientes existentes
- ‚úÖ Eliminar clientes
- ‚úÖ Interfaz responsive con Bootstrap 5
- ‚úÖ Validaci√≥n de formularios
- ‚úÖ Manejo de errores
- ‚úÖ Indicadores de carga
- ‚úÖ **Estados vac√≠os** informativos
- ‚úÖ **Modal de edici√≥n** con datos precargados
- ‚úÖ **Cambio de RUC permitido** - Con validaci√≥n de duplicados
- ‚úÖ **Errores en modal** - Notificaciones contextuales
- ‚úÖ **Campos opcionales** - Solo RUC y Raz√≥n Social son obligatorios
- ‚úÖ **Dise√±o responsive** - Optimizado para m√≥viles, tablets y desktop

## Dise√±o Responsive

### Caracter√≠sticas Responsive

#### **Desktop (1200px+)**
- ‚úÖ **Tabla completa** - Todas las columnas visibles
- ‚úÖ **Layout horizontal** - Controles en fila
- ‚úÖ **Modal grande** - `modal-lg` para mejor visualizaci√≥n
- ‚úÖ **Botones completos** - Texto completo en botones

#### **Tablet (768px - 1199px)**
- ‚úÖ **Tabla adaptada** - Columnas menos importantes ocultas
- ‚úÖ **Layout mixto** - Algunos controles en columna
- ‚úÖ **Modal est√°ndar** - Tama√±o apropiado para tablet
- ‚úÖ **Botones adaptados** - Tama√±o optimizado

#### **M√≥vil (< 768px)**
- ‚úÖ **Tabla compacta** - Solo columnas esenciales
- ‚úÖ **Layout vertical** - Controles apilados
- ‚úÖ **Modal peque√±o** - M√°rgenes reducidos
- ‚úÖ **Botones t√°ctiles** - Tama√±o adecuado para touch
- ‚úÖ **Texto adaptado** - Botones con texto abreviado

### Breakpoints Utilizados

```css
/* M√≥vil peque√±o */
@media (max-width: 576px) { ... }

/* M√≥vil */
@media (max-width: 768px) { ... }

/* Tablet */
@media (max-width: 992px) { ... }

/* Desktop peque√±o */
@media (max-width: 1200px) { ... }
```

### Optimizaciones M√≥viles

#### **Tabla Responsive:**
- **Desktop**: Todas las columnas visibles
- **Tablet**: Oculta tel√©fono y correo
- **M√≥vil**: Solo raz√≥n social + RUC en subt√≠tulo

#### **Controles Adaptativos:**
- **Desktop**: Botones con texto completo
- **M√≥vil**: Botones con iconos y texto abreviado
- **Layout**: Horizontal en desktop, vertical en m√≥vil

#### **Modal Responsive:**
- **Desktop**: Modal grande (`modal-lg`)
- **M√≥vil**: Modal con m√°rgenes reducidos
- **Formulario**: Campos optimizados para touch

## Tecnolog√≠as Utilizadas

- Angular 19
- TypeScript
- Bootstrap 5
- Font Awesome
- RxJS
- Angular Forms

## Configuraci√≥n de Base de Datos

### Requisitos de Base de Datos

1. **Oracle Database** (versi√≥n 11g o superior)
2. **Oracle Client** instalado en el sistema
3. **Usuario de base de datos** con permisos de creaci√≥n de tablas

### Paquetes NuGet Requeridos

El proyecto utiliza los siguientes paquetes NuGet para la conexi√≥n con Oracle:

```xml
<PackageReference Include="Oracle.EntityFrameworkCore" Version="7.21.100" />
<PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="9.0.0" />
<PackageReference Include="AutoMapper.Extensions.Microsoft.DependencyInjection" Version="12.0.1" />
```

#### Instalaci√≥n de Paquetes
```bash
# Desde la carpeta del microservicio
cd microservice/ClienteService/ClienteService.Api

# Instalar paquetes necesarios
dotnet add package Oracle.EntityFrameworkCore --version 7.21.100
dotnet add package Microsoft.EntityFrameworkCore.Tools --version 9.0.0
dotnet add package AutoMapper.Extensions.Microsoft.DependencyInjection --version 12.0.1
```

### Configuraci√≥n de Conexi√≥n

#### 1. Archivo de Configuraci√≥n
Editar `microservice/ClienteService/ClienteService.Api/appsettings.json`:

```json
{
  "ConnectionStrings": {
    "DefaultConnection": "User Id=TU_USUARIO;Password=TU_PASSWORD;Data Source=localhost:1521/TU_SID;"
  }
}
```

#### 2. Par√°metros de Conexi√≥n
- **User Id**: Nombre de usuario de Oracle
- **Password**: Contrase√±a del usuario
- **Data Source**: `host:puerto/SID` (ej: `localhost:1521/xepdb1`)

#### 3. Configuraci√≥n del DbContext
El proyecto utiliza `AppDbContext` configurado en `Program.cs`:

```csharp
builder.Services.AddDbContext<AppDbContext>(options =>
    options.UseOracle(builder.Configuration.GetConnectionString("DefaultConnection")));
```

#### 4. Modelo de Datos
El modelo `Cliente` est√° configurado con las siguientes caracter√≠sticas:
- **Tabla**: `CLIENTE`
- **Clave primaria**: `ID` (autoincremental)
- **Campos obligatorios**: `RUC`, `RAZONSOCIAL`
- **Campos opcionales**: `TELEFONO`, `CORREO`, `DIRECCION`

### Creaci√≥n de la Tabla

#### Opci√≥n 1: Script SQL Manual
```sql
CREATE TABLE CLIENTE (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    RUC VARCHAR2(11) NOT NULL UNIQUE,
    RAZONSOCIAL VARCHAR2(200) NOT NULL,
    TELEFONO VARCHAR2(20),
    CORREO VARCHAR2(100),
    DIRECCION VARCHAR2(200)
);

-- Crear √≠ndices para optimizar b√∫squedas
CREATE INDEX IX_CLIENTE_RUC ON CLIENTE(RUC);
CREATE INDEX IX_CLIENTE_RAZONSOCIAL ON CLIENTE(RAZONSOCIAL);
```

#### Opci√≥n 2: Migraciones de Entity Framework
```bash
# Desde la carpeta del microservicio
cd microservice/ClienteService/ClienteService.Api

# Instalar herramientas de EF Core
dotnet tool install --global dotnet-ef

# Crear migraci√≥n inicial
dotnet ef migrations add InitialCreate

# Aplicar migraci√≥n a la base de datos
dotnet ef database update
```

### Estructura de la Tabla

| Campo | Tipo | Longitud | Obligatorio | Descripci√≥n |
|-------|------|----------|-------------|-------------|
| ID | NUMBER | - | S√≠ (PK) | Identificador √∫nico autoincremental |
| RUC | VARCHAR2 | 11 | S√≠ | RUC del cliente (√∫nico) |
| RAZONSOCIAL | VARCHAR2 | 200 | S√≠ | Raz√≥n social del cliente |
| TELEFONO | VARCHAR2 | 20 | No | Tel√©fono de contacto |
| CORREO | VARCHAR2 | 100 | No | Correo electr√≥nico |
| DIRECCION | VARCHAR2 | 200 | No | Direcci√≥n f√≠sica |

### Verificaci√≥n de Conexi√≥n

#### 1. Probar Conexi√≥n
```bash
# Desde la carpeta del microservicio
cd microservice/ClienteService/ClienteService.Api

# Ejecutar el proyecto
dotnet run
```

#### 2. Verificar en Swagger
- Abrir: `http://localhost:4200/swagger`
- Probar endpoint: `GET /api/cliente`
- Debe devolver lista vac√≠a `[]` si no hay datos

### Soluci√≥n de Problemas

#### Error de Conexi√≥n
```
Oracle.ManagedDataAccess.Client.OracleException: ORA-12541: TNS:no listener
```
**Soluci√≥n**: Verificar que Oracle Database est√© ejecut√°ndose y el puerto 1521 est√© abierto.

#### Error de Autenticaci√≥n
```
Oracle.ManagedDataAccess.Client.OracleException: ORA-01017: invalid username/password
```
**Soluci√≥n**: Verificar credenciales en `appsettings.json`.

#### Error de SID
```
Oracle.ManagedDataAccess.Client.OracleException: ORA-12505: TNS:listener does not currently know of SID
```
**Soluci√≥n**: Verificar el SID correcto en la cadena de conexi√≥n.

### Datos de Prueba

#### Insertar Datos de Ejemplo
```sql
-- Insertar clientes de prueba
INSERT INTO CLIENTE (RUC, RAZONSOCIAL, TELEFONO, CORREO, DIRECCION) 
VALUES ('20123456789', 'Empresa Demo S.A.C.', '987654321', 'demo@empresa.com', 'Av. Principal 123');

INSERT INTO CLIENTE (RUC, RAZONSOCIAL, TELEFONO, CORREO, DIRECCION) 
VALUES ('20987654321', 'Comercial ABC S.R.L.', '912345678', 'ventas@comercialabc.com', 'Jr. Comercio 456');

INSERT INTO CLIENTE (RUC, RAZONSOCIAL, TELEFONO, CORREO, DIRECCION) 
VALUES ('20111222333', 'Servicios XYZ E.I.R.L.', '955566677', 'info@serviciosxyz.com', 'Av. Industrial 789');
```

#### Verificar Datos
```sql
-- Consultar todos los clientes
SELECT * FROM CLIENTE;

-- Consultar por RUC
SELECT * FROM CLIENTE WHERE RUC = '20123456789';

-- Buscar por raz√≥n social
SELECT * FROM CLIENTE WHERE RAZONSOCIAL LIKE '%Demo%';
```

## Requisitos Previos

### Desarrollo Frontend
- Node.js (versi√≥n 18 o superior)
- npm o yarn
- Angular CLI (opcional)

### Desarrollo Backend
- .NET 9.0 SDK
- Oracle Database (versi√≥n 11g o superior)
- Oracle Client instalado

### Ejecuci√≥n
- El microservicio de clientes debe estar ejecut√°ndose en `http://localhost:4200`
- La base de datos Oracle debe estar configurada y accesible

## Instalaci√≥n

### 1. Configurar Base de Datos

#### Crear la Tabla CLIENTE
```sql
CREATE TABLE CLIENTE (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    RUC VARCHAR2(11) NOT NULL UNIQUE,
    RAZONSOCIAL VARCHAR2(200) NOT NULL,
    TELEFONO VARCHAR2(20),
    CORREO VARCHAR2(100),
    DIRECCION VARCHAR2(200)
);
```

#### Configurar Conexi√≥n
Editar `microservice/ClienteService/ClienteService.Api/appsettings.json` con tus credenciales de Oracle.

### 2. Instalar y Ejecutar Backend

```bash
# Navegar al microservicio
cd microservice/ClienteService/ClienteService.Api

# Instalar paquetes NuGet
dotnet restore

# Ejecutar el backend
dotnet run
```

### 3. Instalar y Ejecutar Frontend

```bash
# Navegar al frontend
cd frontend/cliente-app

# Instalar dependencias
npm install

# Ejecutar el frontend
npm start
```

### 4. Verificar Aplicaci√≥n

- **Backend**: `http://localhost:4200/swagger`
- **Frontend**: `http://localhost:4201`

## Configuraci√≥n

1. Aseg√∫rate de que el microservicio est√© ejecut√°ndose en `http://localhost:4200`
2. Si el microservicio est√° en un puerto diferente, actualiza la URL en `src/app/services/cliente.service.ts`

## Ejecuci√≥n

### **Paso 1: Ejecutar el Backend**

Abre una terminal y ejecuta:

```bash
cd microservice/ClienteService/ClienteService.Api
dotnet run
```

El backend estar√° disponible en `http://localhost:4200`

### **Paso 2: Ejecutar el Frontend**

Abre otra terminal y ejecuta:

```bash
cd frontend/cliente-app
npm install
npm start
```

El frontend estar√° disponible en `http://localhost:4201`

### **Paso 3: Acceder a la Aplicaci√≥n**

Abre tu navegador y ve a `http://localhost:4201`

## üöÄ Comandos R√°pidos

### **Ejecutar Todo (2 terminales)**

**Terminal 1 - Backend:**
```bash
cd microservice/ClienteService/ClienteService.Api && dotnet run
```

**Terminal 2 - Frontend:**
```bash
cd frontend/cliente-app && npm install && npm start
```

### **URLs de Acceso**
- **Frontend**: http://localhost:4201
- **Backend API**: http://localhost:4200/api/cliente
- **Swagger (si est√° habilitado)**: http://localhost:4200/swagger

## Construcci√≥n

Para construir la aplicaci√≥n para producci√≥n:

```bash
npm run build
```

Los archivos de construcci√≥n se generar√°n en el directorio `dist/`.

## Estructura del Proyecto

```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cliente-list.component.ts    # Componente principal de gesti√≥n
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cliente.service.ts          # Servicio para comunicaci√≥n con API
‚îÇ   ‚îú‚îÄ‚îÄ app.component.ts                # Componente ra√≠z
‚îÇ   ‚îú‚îÄ‚îÄ app.config.ts                   # Configuraci√≥n de la aplicaci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ app.routes.js                   # Configuraci√≥n de rutas
‚îú‚îÄ‚îÄ styles.scss                         # Estilos globales
‚îî‚îÄ‚îÄ index.html                          # P√°gina principal
```

## Configuraci√≥n de Puertos

### **Backend (.NET)**
- **HTTP**: `http://localhost:4200`
- **HTTPS**: `https://localhost:4201`

### **Frontend (Angular)**
- **Puerto**: `4201`
- **URL**: `http://localhost:4201`

## API Endpoints

La aplicaci√≥n se conecta con los siguientes endpoints del microservicio:

- `GET /api/cliente` - Obtener todos los clientes
- `GET /api/cliente/{ruc}` - Obtener cliente por RUC
- `GET /api/cliente/search?razonSocial={texto}` - Buscar clientes
- `POST /api/cliente` - Crear nuevo cliente
- `PUT /api/cliente/{ruc}` - Actualizar cliente
- `PATCH /api/cliente/{ruc}` - Actualizaci√≥n parcial
- `DELETE /api/cliente/{ruc}` - Eliminar cliente

## Funcionalidades

### Lista de Clientes
- Visualizaci√≥n de todos los clientes en una tabla
- Informaci√≥n mostrada: RUC, Raz√≥n Social, Tel√©fono, Correo, Direcci√≥n
- Botones de acci√≥n para editar y eliminar

### B√∫squeda Avanzada
- **B√∫squeda en tiempo real** mientras escribes (debounce de 300ms)
- **B√∫squeda por RUC y Raz√≥n Social** simult√°neamente
- **Resaltado de t√©rminos** encontrados en los resultados
- **Indicador de b√∫squeda** con spinner animado
- **Bot√≥n para limpiar b√∫squeda** f√°cilmente
- **Contador de resultados** en tiempo real

### Formulario de Cliente
- Modal para crear/editar clientes
- Validaci√≥n de campos obligatorios (RUC y Raz√≥n Social)
- Validaci√≥n de formato de email
- L√≠mites de caracteres seg√∫n el modelo del backend

### Ordenamiento y Filtros
- **Ordenamiento** por cualquier columna (RUC, Raz√≥n Social, Tel√©fono, Correo)
- **Orden ascendente/descendente** con indicador visual
- **Filtros din√°micos** que se aplican en tiempo real
- **Contador de resultados** siempre visible
- **Reset autom√°tico** de filtros al actualizar datos

### Gesti√≥n de Estados
- Indicadores de carga durante las operaciones
- Mensajes de √©xito y error
- Confirmaci√≥n antes de eliminar
- **Estados vac√≠os** informativos con acciones sugeridas
- **Estados de b√∫squeda** sin resultados con opciones de limpieza

## Personalizaci√≥n

### Cambiar URL del API
Edita el archivo `src/app/services/cliente.service.ts` y modifica la variable `apiUrl`:

```typescript
private apiUrl = 'http://tu-servidor:puerto/api/cliente';
```

### Modificar Estilos
Los estilos personalizados est√°n en `src/styles.scss`. Puedes modificar:
- Colores del tema
- Tipograf√≠as
- Espaciados
- Animaciones

## Soluci√≥n de Problemas

### Error de CORS
Si encuentras errores de CORS, aseg√∫rate de que el microservicio tenga configurado CORS para permitir requests desde `http://localhost:4201`.

### Error de Conexi√≥n
Verifica que:
1. El microservicio est√© ejecut√°ndose
2. La URL del API sea correcta
3. No haya problemas de firewall

### Problemas de Dependencias
Si hay problemas con las dependencias:
```bash
rm -rf node_modules package-lock.json
npm install
```

## Contribuci√≥n

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/nueva-funcionalidad`)
3. Commit tus cambios (`git commit -am 'Agregar nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/nueva-funcionalidad`)
5. Crea un Pull Request

## Licencia

Este proyecto est√° bajo la Licencia MIT.